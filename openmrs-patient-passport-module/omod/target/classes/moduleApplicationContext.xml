<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <!-- ========================================== -->
    <!-- ENHANCED AOP WITH MULTIPLE BEAN PATTERNS   -->
    <!-- ========================================== -->

    <!-- Define the Observation Save Advice (AOP approach) -->
    <!-- Observation AOP advice temporarily disabled due to interference with OpenMRS Hibernate event interceptor.
       This module previously proxied the core ObsService which caused a NullPointerException inside
       org.openmrs.event.api.db.hibernate.HibernateEventInterceptor.onSave when the ThreadLocal used by
       OpenMRS event system was not initialized by our advice. To avoid crashing OpenMRS, the proxy is
       disabled here. Re-enable only after implementing a safe post-save listener or ensuring proper
       initialization of OpenMRS authentication stack in the interceptor. -->
    <!--
    <bean id="observationSaveAdvice" 
        class="org.openmrs.module.patientpassport.advice.ObservationSaveAdvice"/>
    -->

    <!-- AOP proxying of the core ObsService removed to prevent NullPointerException during Hibernate events.
         If you need to run logic after an observation is saved, implement a dedicated OpenMRS event listener
         or use a safe post-commit mechanism rather than proxying ObsService directly. -->

</beans>
